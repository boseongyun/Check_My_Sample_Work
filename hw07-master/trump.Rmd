---
title: "President Donald Trump"
author: "Boseong Yun"
date: "`r lubridate::today()`"
output:
  github_document:
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

# Loading Library 
library(tidyverse)
library(modelr) #data_grid() function
library(here) # here() function
library(knitr) # kable() function
library(broom) # tidy and augment() function
library(dendroTools) # round_df() function
```


```{r include = FALSE}
# Importing Data Frame
trump <- readr::read_csv(here::here("data", "trump.csv")) # Using here package to increase reproducibility
```

## Part 1. Estimate a basic (single variable) linear regression model of the relationship between the importance of the video and feelings towards Donald Trump.

* **Research Prediction**: Since the video contains footage of Donald Trump speaking vulgar language, I predict that the importance of the video is going to be negatively associated with the feelings towards Donald Trump. 

* **Exploratory Data Analysis**: The plot shows the distributiuon of feelings of warmth towards Trump across different levels of importance of the video felt by the viewers. *Plot 1* shows that higher levels of importance of the video is associated with colder responses towards Donald Trump. *Plot 2* where  extreme levels of feelings, 0 and 100, towards Donald Trump have been omitted also show a smiliar negative trend with a slight change in the slope of the coefficient from the plot 1. These graphs indicate that the levels of importance are negative associated with the warm feelings towards Trump

```{r trump_mod_vis, warning = FALSE, message = FALSE}
# It is helpful to make a visual representation of the relationship before conducting regression analysis.


# Plot 1: The Relationship between the importance of video and feelings of warmth towards Trump (original data)
trump %>%
  ggplot(aes(x = video, y = trump)) +
  geom_point(alpha = 0.1) +
  geom_smooth(method = "lm") + # specifying the method argument to "linear model" 
  labs(
    title = "Figure 1: There is a postivie relationship betweeen the importance of video \nand feelings of warmth towards Trump",
    x = "Importance of Video", 
    y = "Feelings of Warmth"
    )

# Plot2: The Relationship between the importance of video and feelings of warmth towards Trump with filtered data added.
trump_moderated <- trump %>%
  filter(trump != 100 & trump != 0)

# Plot Combined together
trump %>%
  ggplot(aes(x = video, y = trump)) +
  geom_point(alpha = 0.1) +
  geom_smooth(method = "lm", color = "blue") + # specifying the method argument to "linear model" 
  geom_smooth(aes(x = video, y = trump), data = trump_moderated, method = "lm", color = "red") +
  annotate("text", x = 3.9, y = 28, label = "filtered data", color = "red") +
  annotate("text", x = 3.9, y = 15, label = "original data", color = "blue") +
  labs(
    title = "Figure 1: There is a negative relationship betweeen the importance of video \nand feelings of warmth towards Trump",
    x = "Importance of Video", 
    y = "Feelings of Warmth"
    )
```

* **Simple Linear Regression**: The coefficient on the video variable shows that a unit increase in the importance of video is statistically associated with a decrease of 16.0954 points of feelings of warmth towards Trump at the 95% confidence levels. Likewise, the coefficient on the intercept indicates that it is stastically significant that people who do not believe in the importance of video has 71.2008 points of feelings of warmth towards Trump. The t-staticis for both of the coefficients indicate that they are significant. Furthermore, the adjusted-R squared shows that the video variaible explains 47.96 percents of variation in the trump variable. The regression output for the filtered dataset also show statistically significant results with slight changed as indicated in the *Table 1*.

```{r trump_mod_df}
# Basic Linear Relationship using video as the explanatory variable.
lm_video <- 
  lm(trump ~ video, data = trump) %>% 
  tidy(conf.int = TRUE) %>%
  round_df(digits = 2)

lm_video_mod <- 
  lm(trump ~ video, data = trump_moderated) %>% 
  tidy(conf.int = TRUE) %>%
  round_df(digits = 2)

# Table 1: Regression Output on the Feelings of Warmth Towards Trump
bind_rows(lm_video, lm_video_mod, .id = "id") %>%
  kable(
    format = "pandoc",
    caption = "Table 1: Regression Output on the Feelings of Warmth Towards Trump",
    col.names = c("Data", "Variable", "Estimate", "Standard Error", "T Stat", "P-Value",
                  "Lower 95%", "Upper 95%")
    )
```

## Part 2: 
The video contains elements that could be construed as sexist, if not misogynistic, by many people. I would thus like to study gendered patterns in the perception towards Trump. Specifically, I would like to see the interaction effects of gender with levels of education, importance of video, and political indentifications on the attitudes towards Trump. I predict that female with higher levels of education are going to have negative feelings on Trump. Also, I think that females who belive that the video is important are more likely to hate Trump then the male counterparts. For politicial identification, female who support the Republicans are less likely to hate trump than those who support Democrats. (I have limited the education levels to high school graduates, Bahcelor's, and Doctor's to make infomred analyses based on the documentation uploaded on the homework webpage in the entire dataset)

```{r include = FALSE}
# Converting variables into factors. This transformation cleans up the column names and thus is better then using factor() within the lm function. 
trump_fct <- trump %>%
  mutate(
    video = factor(video),
    female = factor(female),
    pid = factor(pid),
    educ = factor(educ)
  ) %>%
  filter(educ %in% c(8, 12, 15)) # Selecting high school, bachelor, and doctoral levels
```

### 2-1: Regression with Education and Female with their Interaction Effects
* EDA: The graph shows that higher education levels seem to be associated with more negative feelings towards Trump. This is reasonable because people who have received higher education tend to dislike profanities and vulgaries. The interaction effect wtih gender also show that women are more likely to hate Trump than the male counterparts with the same level of education. For instance, the estimate for women in every level of education have negative average feelings towards Trump. It is important to note that the confidence intervals for these interaction effect show that women do not *always* hate Trump more than men. Despite the fact thay they are on average more likely to hate trump, the confidence interval lies both negative and positive including zero. Although this pattern where women on average are more likely to hate Trump is as expected, it is interesting to see that they are not always the case. There must be other control variables to see the effects more clearly.

```{r lm_educ_vis}
# Investigating the relationship between trump and education levels
lm_educ <- 
  lm(trump ~ educ + female + educ*female, data = trump_fct) %>% 
  tidy(conf.int = TRUE) %>%
  round_df(digits = 2) %>%
  # Using str_replace_all to change the variables to easily interpretable names
  mutate(term = str_replace_all(term, pattern = c("(Intercept)" = "High School",
                                                  "educ12" = "Bachelor's",
                                                  "educ15" = "Doctor's",
                                                  "female1" = "Female",
                                                  "educ12:female1" = "Bachelor's:Female",
                                                  "educ15:female1" = "Doctor's:Female")))

# Setting the factor levels for the term for clear visualization
lm_educ$term <- factor(lm_educ$term, levels = c("(High School)", "Female",
                                                "Bachelor's", "Bachelor's:Female",
                                                "Doctor's", "Doctor's:Female"))

# Visual Representation of support for trump across different education levels
lm_educ %>%
  mutate(interaction = ifelse(str_detect(term, pattern = "e$"), TRUE, FALSE)) %>% # creating additional variables to make effective visualzation
  ggplot(aes(x = estimate, y = reorder(term, desc(term)))) +
  geom_pointrange(aes(xmin = conf.low, xmax = conf.high)) +
  geom_point(aes(color = interaction), size = 3) +
  geom_vline(xintercept = 0, linetype = 3) +
  theme(legend.position = "none") +
  labs(
    y = "",
    x = "esimate",
    title = "The Coefficient Plot for Education and Female Variables on feelings \nof warmth towards Trump",
    caption = "Source: 2012 American National Election Studies Survey"
  )
```

* Regression: The regresion output shows that the coefficients for Bachelor's and all the interaction variables are not statistically significant. In other words, we cannot reject the null hypothesis that female with higher levels of education are not statistically associated with colder attitudes towards Trump. These results are different from what I expected since I thought females with higher levels of education were going to be more sensitive to the wrongdoings of Trump. There must be more control variables such as race and income that could cause potential omitted variable bias to evaluate the interaction effect of gender with education levels. 

```{r lm_educ_df}
# Table 2: Regression Output on the Feelings of Warmth Towards Trump
lm_educ %>%
    kable(
    format = "pandoc",
    caption = "Table 2: Regression Output on the Feelings of Warmth Towards Trump",
    subtitle = ("the interaction effects are not statistically significant"),
    col.names = c("Variable", "Estimate", "Standard Error", "T Stat", "P-Value",
                  "Lower 95%", "Upper 95%")
    )
```

### 2-2: Regression with Video and Female with their Interaction Effects
* EDA: The graph shows a  sbutle trend where women on averaege are more likely to hate trump than the male counterparts. For instance, the average coeffcient on the interaction variable between female and video move towards the negative value as the level of importance of video increases. This trend is as expected since those who believe that the videos are important tend to have high consciousness about gender issues and because women are being targeted in the video. As in the previous analysis, however, the confidence intervals for each interaction variable shows that women do not *always* hate Trump more than the male counterparts. Further variables such as race and income must be added to show the interaction effects more clearly.

```{r lm_video_vis, echo = FALSE}
# Investigating the relationship between trump and importance of video
lm_video <- 
  lm(trump ~ video + female + video*female, data = trump_fct) %>% 
  tidy(conf.int = TRUE) %>%
  round_df(digits = 2) %>% 
  mutate(term = str_replace_all(term, c("(Intercept)" = "video0", "female1" = "female")))

# Exploratory Data Analysis: The relatioship between 
lm_video %>%
  mutate(interaction = ifelse(str_detect(term, pattern = "e$"), TRUE, FALSE)) %>% # creating additional variables to make effective visualzation
  ggplot(aes(x = estimate, y = reorder(term, desc(term)))) +
  geom_pointrange(aes(xmin = conf.low, xmax = conf.high)) +
  geom_point(aes(color = interaction), size = 3) +
  geom_vline(xintercept = 0, linetype = 3) +
  theme(legend.position = "none") +
  labs(
    y = "",
    x = "esimate",
    title = "The Coefficient Plot for Video and Female Variables on feelings \nof warmth towards Trump",
    caption = "Source: 2012 American National Election Studies Survey"
  )
```

* Regression: The regresion output shows that the coefficients for all the interaction variables between female and level of importance are not statistically significant. In other words, we cannot reject the null hypothesis that female who value the video more are not statistically associated with colder attitudes towards Trump. These results are different from what I expected since I thought females with stronger levels of importance about the video to be more sensitive to the wrongdoings of Trump. 

```{r lm_vid_df}
# Table 3: Regression Output on the Feelings of Warmth Towards Trump
lm_video %>% 
  kable(
    format = 'pandoc',
    caption = "Table 3: Regression Output on the Feelings of Warmth Towards Trump",
    subtitle = ("the interaction effects are not statistically significant"),
    col.names = c("Variable", "Estimate", "Standard Error", "T Stat", "P-Value",
                  "Lower 95%", "Upper 95%")
  )
```

### 2-3: Regression with Political Identification and Female with their Interaction Effects
* EDA: The graph shows that there is a quadratic trend where the interaction effects between political identification and female variable. For instance, female with storng political identification either as a Democrat and Republican are more likely on average to have warm feelings towards Trump than those who have moderate political identifications. This is different from what I expected since I thought there was going to be a linear relationship where strong female Republicans are more likely to support Trump than strong female Democrats. This might be due to the fact that people who have strong political ideals are more likely to be concerned about national security and economy than other important national affairs. This graph also shows that none of the interaction effects are siginificant with their confidence intervals containing both positive and negative value including zero.

```{r lm_pid_vis}
# Investigating the relationship between political identification and importance of video
lm_pid <- 
  lm(trump ~ pid + female + pid*female, data = trump_fct) %>% 
  tidy(conf.int = TRUE) %>%
  round_df(digits = 2)  %>% 
  mutate(term = str_replace_all(term, c("(Intercept)" = "pid0", "female1" = "female")))

# Exploratory Analysis
lm_pid %>%
  mutate(interaction = ifelse(str_detect(term, pattern = "e$"), TRUE, FALSE)) %>% # creating additional variables to make effective visualzation
  ggplot(aes(x = estimate, y = reorder(term, desc(term)))) +
  geom_pointrange(aes(xmin = conf.low, xmax = conf.high)) +
  geom_point(aes(color = interaction), size = 3) +
  geom_vline(xintercept = 0, linetype = 3) +
  theme(legend.position = "none") +
  labs(
    y = "",
    x = "esimate",
    title = "The Coefficient Plot for Political Identifcation and Female Variables on feelings \nof warmth towards Trump",
    caption = "Source: 2012 American National Election Studies Survey"
  )
```

* Regression: The regresion output shows that the coefficients for all the interaction variables between female and political identifcation are not statistically significant. In other words, we cannot reject the null hypothesis that female who are strong Republicans are not statistically associated with warmer attitudes towards Trump. These results are different from what I expected since I thought females with stronger Reublican values would be more lenient twoards the wrongdoings of Trump. 


```{r lm_pid_df}
# Table 4: Regression Output on the Feelings of Warmth Towards Trump
lm_pid %>% 
  kable(
    format = "pandoc",
    caption = "Table 4: Regression Output on the Feelings of Warmth Towards Trump",
    subtitle = ("the interaction effects are not statistically significant"),
    col.names = c("Variable", "Estimate", "Standard Error", "T Stat", "P-Value",
                  "Lower 95%", "Upper 95%")
    )
```

# Conclusion
Despite the fact that the video contains many elements that could be construed as either sexist or misogynistic, none of the interaction effects for female were statistically significant. These results were rather surprising. Although not satistically significant, however, we were still able to witness the changes in the patterns in which we found females were less likely to view trump positively.


## Session info

```{r}
devtools::session_info()
```
